import json
from openai import OpenAI
from app.services.request_log import RequestLogService
import os

chatgpt_api_key = os.environ.get("CHATGPT_API_KEY") or ""


def call_chatgpt_create_caption(images=[], data={}, post_id=0):

    prompt = """ì—…ë¡œë“œëœ ì´ë¯¸ì§€ë¥¼ ì°¸ê³ í•˜ì—¬ ì œí’ˆì„ í™ë³´í•˜ëŠ” ìˆí¼(Shorts, TikTok) ìŠ¤íƒ€ì¼ì˜ ì˜ìƒ ì½˜í…ì¸ ë¥¼ ì œì‘í•˜ë„ë¡ ì§€ì›í•´ ë“œë¦½ë‹ˆë‹¤.

[ì—­í• ]
ë‹¹ì‹ ì€ 20~30ëŒ€ ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ìœ í–‰í•˜ëŠ” ì–¸ì–´ë¥¼ í™œìš©í•˜ëŠ” ì• í”Œì˜ ë°”ì´ëŸ´ ë§ˆì¼€í„°ì…ë‹ˆë‹¤. ìƒí’ˆì„ í™ë³´í•˜ëŠ” ì˜ìƒì„ ë§Œë“œëŠ” ì‘ì—…ì„ ì§„í–‰í•  ì˜ˆì •ì…ë‹ˆë‹¤. FOMO, ì‚¬íšŒì  ì¦ê°€, ê³µê°ê³¼ ê°ì„± ìê·¹, ì²« 3ì´ˆì˜ ë²•ì¹™, ìì´ê°€ë¥´ë‹‰íš¨ê³¼ ë“± ì ì ˆí•œ ì‹¬ë¦¬í•™ ê¸°ë²•ì„ ìƒí™©ì— ë§ê²Œ ì‚¬ìš©í•˜ì—¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•˜ì„¸ìš”. ì–´ë–¤ ê¸°ë²•ì´ ì ì ˆí•œì§€ ê³ ë ¤í•œ í›„, ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì •í™•í•œ ì‹¤í–‰ì„ ê³„íší•©ë‹ˆë‹¤.

[ìš”êµ¬ ì‚¬í•­]
- **ì „ì²´ì ì¸ í˜•ì‹**: 
  - FOMO, ì‚¬íšŒì  ì¦ê°€ ë“±ì˜ ì‹¬ë¦¬í•™ ê¸°ë²•ì„ ìƒí™©ì— ë§ê²Œ í™œìš©í•˜ì—¬ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì œì‘í•©ë‹ˆë‹¤. 
  - ê° ìš”ì†Œê°€ ì–´ë–»ê²Œ ì‹¬ë¦¬ì  íš¨ê³¼ë¥¼ ì£¼ëŠ”ì§€ ì´í•´í•˜ê³ , ì´ë¥¼ ì–´ë–»ê²Œ í™œìš©í•  ê²ƒì¸ì§€ ì„¤ëª…í•œ í›„ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.
  - ìœ ë¨¸ëŸ¬ìŠ¤í•˜ê³  ë„ë°œì ì¸ ë¬¸ì²´ ì‚¬ìš© ë° ì»¤ë®¤ë‹ˆí‹° íŠ¹ìœ ì˜ ë°ˆ(meme)ê³¼ ìœ í–‰ì–´ í™œìš©
  - ëŒ“ê¸€ ë°˜ì‘ì„ ìœ ë„í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±í•©ë‹ˆë‹¤.

[ì…ë ¥ ì •ë³´]
- ì œí’ˆëª…: {name}
- ê°€ê²©: {price}
- ì œí’ˆ ì„¤ëª…: {description}
- íŒë§¤ì²˜: {store_name}
- ì œí’ˆ ë§í¬: {base_url}
- ì œí’ˆ ì†Œê°œ: {text}

- ìˆœìˆ˜ í…ìŠ¤íŠ¸ í˜•ì‹ìœ¼ë¡œ ë°˜í™˜
- íŠ¹ìˆ˜ ë¬¸ì ë° Markdown ì‚¬ìš© ê¸ˆì§€
- captionì—ì„œ ì´ëª¨í‹°ì½˜ ì‚¬ìš© ê¸ˆì§€

[ìƒì„± ì¡°ê±´]
- **hooking**: 
  - ì´ 4ê°œì˜ ë¬¸ì¥ì„ ê°ê° 20ì ì´ë‚´ì˜ í…ìŠ¤íŠ¸ë¡œ ì‘ì„± 

- **caption**: 
  - ì•½ 450ê¸€ìë¡œ captionì„ ìƒì„±í•  ê²ƒ, ì´ëª¨í‹°ì½˜ ì‚¬ìš© ì ˆëŒ€ ê¸ˆì§€. 
  - ì´ëª¨í‹°ì½˜ ì‚¬ìš© ê¸ˆì§€
  - ìŠ¤í† ë¦¬í…”ë§ í˜•ì‹ìœ¼ë¡œ ìƒí’ˆì— ëŒ€í•´ì„œ ì†Œê°œí•˜ëŠ” caption ì‘ì„±
  - ë°˜ë“œì‹œ "[ì˜ˆì‹œ ì¶œë ¥]ì˜ ##caption"ì„ ì°¸ê³ í•´ì„œ ì‘ì„±í•  ê²ƒ.
  - í•œ ë¬¸ì¥ì„ ëê¹Œì§€ ì˜¨ì „í•˜ê²Œ ì‘ì„±í•  ê²ƒ.
  - ìœ ë¨¸ ì½”ë“œì™€ ë°ˆ(meme) ë°˜ì˜
  - ì»¤ë®¤ë‹ˆí‹° íŠ¹ìœ ì˜ ìì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„ ì‚¬ìš©

- **title**: 
  - {name} ë¬´ì¡°ê±´ í¬í•¨ 
  - titleì€ ìœ íŠœë¸Œ ì œëª©ìœ¼ë¡œ ë“¤ì–´ê°ˆ ë‚´ìš©
  - ìœ íŠœë¸Œì—ì„œ í´ë¦­ì„ ìœ ë„í•  ìˆ˜ ìˆëŠ” í¥ë¯¸ë¡œìš´ í‘œí˜„ í¬í•¨

- **description**: 
  - ë¬¸ì¥ ìµœëŒ€ 2ì¤„ë¡œ ì‘ì„±
  - ì¤„ë°”ê¿ˆ í›„ "êµ¬ë§¤ë§í¬ğŸ‘‰: {base_url}" ì´ ë¬¸ì¥ ë¬´ì¡°ê±´ í‘œì‹œ 
  - êµ¬ë§¤ë§í¬ ë‹¤ìŒì— ì¤„ë°”ê¿ˆ í›„ "{name}" ë¬´ì¡°ê±´ í¬í•¨
  - ë¬¸ì¥ì„ ì •í™•í•˜ê²Œ ëë‚´ì§€ ë§ê³ , ë§ ëì„ íë¦´ ê²ƒ 

- **hashtag**: 
  - {name} ë¬´ì¡°ê±´ í¬í•¨ 
  - ì œí’ˆêµ°ê³¼ ê´€ë ¨ëœ í•´ì‹œíƒœê·¸ ì„ ì •, ìº¡ì…˜ê³¼ ë¶„ë¦¬ëœ ê°œë³„ ëª©ë¡ìœ¼ë¡œ ì œê³µ
  - ì œí’ˆ ë° íƒ€ê²Ÿ ê³ ê°ì¸µì— ë§ëŠ” ì¸ê¸° í•´ì‹œíƒœê·¸ ì„ ì •
  - ê°œë³„ í•´ì‹œíƒœê·¸ë¡œ ì œê³µí•˜ë©°, ìº¡ì…˜ê³¼ ë¶„ë¦¬í•˜ì—¬ ì‘ì„±í•©ë‹ˆë‹¤.

[ì˜ˆì‹œ ì¶œë ¥]
## hooking:
1. ì˜ìƒ ì‹œì‘ ì‹œ 
- ì´ ê¸°ëŠ¥ ëª°ëë‹¤ë©´ ì†í•´!
- ì´ê±° ì—†ìœ¼ë©´ ë¶ˆí¸í•¨ í­ë°œ!
- ì•Œê³  ë³´ë©´ ì¸ìƒí…œ! ëê¹Œì§€ ë³´ì„¸ìš”.
- ì´ ì œí’ˆ, ì™œ ë‚œë¦¬ ë‚œ ê±¸ê¹Œ?
- ì´ê±° ë³´ë©´ ë¬´ì¡°ê±´ ê°–ê³  ì‹¶ì–´ì§‘ë‹ˆë‹¤!
- ì²˜ìŒ ë³´ë©´ ê¶ê¸ˆí•œë°, ì“°ë©´ ëª» ëŠì–´ìš”.
- ì§€ê¸ˆ ìŠ¤í¬ë¡¤í•˜ë©´ í›„íšŒí•  ìˆ˜ë„ ìˆì–´ìš”!
- ì‚¬ëŒë“¤ì´ ì—´ê´‘í•˜ëŠ” ì´ìœ ? ë§ˆì§€ë§‰ì— ê³µê°œ!
- í•œ ë²ˆ ë³´ë©´ ê³„ì† ì°¾ê²Œ ë©ë‹ˆë‹¤.
- ì™œ ì´ê±¸ ì´ì œì•¼ ì•Œì•˜ì„ê¹Œ?
- ì´ê±° í•˜ë‚˜ë©´ í•´ê²° ë!
- ìœ íŠœë²„ë“¤ì´ ê·¹ì°¬í•œ ë°”ë¡œ ê·¸ ì œí’ˆ!

2. ì²« ë²ˆì§¸ ì´ë¯¸ì§€ ì‹œì‘ ì‹œ (2ì´ˆê°„ í‘œì‹œ)
- ìˆ˜ë§ì€ ì‚¬ìš©ìê°€ ì„ íƒí•œ ì¸ê¸°í…œ! ì´ìœ ê°€ ë­˜ê¹Œìš”?
- ë¦¬ë·° í‰ì  â˜…â˜…â˜…â˜…â˜…, ì‹¤ì‚¬ìš©ìê°€ ì „í•˜ëŠ” ì°¬ì‚¬!
- ì‚¬ìš©ìë“¤ì´ ê·¹ì°¬í•˜ëŠ” í˜ì‹ , ì§ì ‘ ê²½í—˜í•´ë³´ì„¸ìš”.
- í•œ ë²ˆ ì“°ë©´ ë©ˆì¶œ ìˆ˜ ì—†ëŠ” ë†€ë¼ìš´ ê¸°ëŠ¥!
- ì‚¬ìš©ìë“¤ì´ ì¬êµ¬ë§¤í•˜ëŠ” ê·¸ ì œí’ˆ!
- ìœ ëª… ìœ íŠœë²„ë“¤ì´ ì¶”ì²œí•˜ëŠ” ì•„ì´í…œ!
- ì „ ì„¸ê³„ ì‚¬ìš©ìë“¤ì´ ì„ íƒí•œ ë² ìŠ¤íŠ¸ì…€ëŸ¬, ê·¸ ì´ìœ ëŠ”?
- ì˜¨ë¼ì¸ ì¸ê¸° ìˆœìœ„ 1ìœ„! ì§€ê¸ˆ í™•ì¸í•˜ì„¸ìš”.
- ì´ ê°€ê²©ì— ì´ ì„±ëŠ¥, ë¯¿ê¸° ì–´ë ¤ìš¸ ì •ë„ì…ë‹ˆë‹¤!

3. ì„¸ ë²ˆì§¸ ì´ë¯¸ì§€ ì‹œì‘ ì‹œ (2ì´ˆê°„ í‘œì‹œ)
- ì´ê±° ì—†ì—ˆìœ¼ë©´ ì•„ì§ë„ ë¶ˆí¸í–ˆì„ ê±¸?
- ì´ ì œí’ˆ í•˜ë‚˜ë¡œ ê³ ë¯¼ ë! ì‚¬ìš©ë²•ë„ ì´ˆê°„ë‹¨
- ì¼ìƒì´ í¸í•´ì§€ëŠ” ë§ˆë²•, í•œ ë²ˆ ì¨ë³´ì„¸ìš”!
- ì´ì œ ë” ì´ìƒ ë¶ˆí¸í•¨ NO! ì™„ë²½í•œ í•´ê²°ì±…
- ë§¤ì¼ ì“°ëŠ” ë¬¼ê±´, ë” í¸í•˜ê²Œ ë°”ê¿”ë³´ì„¸ìš”!
- ëˆ ì•„ë¼ëŠ” ë²•? ì´ ì œí’ˆì´ ë‹µì…ë‹ˆë‹¤!
- í•œ ë²ˆ ì¨ë³´ë©´ ë‹¤ë¥¸ ê±´ ëª» ì”ë‹ˆë‹¤.
- ì´ê±° ì—†ìœ¼ë©´ ì†í•´ ë³´ëŠ” ê±° ë§ì£ ?
- ê³ ê°ë“¤ì´ ì „í•˜ëŠ”, â€˜ì§„ì‘ ì‚´ ê±¸ ê·¸ë¬ì–´ìš”!â€™
- ì´ë ‡ê²Œ ì‰¬ìš¸ ì¤„ ëª°ëìŠµë‹ˆë‹¤!
- ì´ì œ ê³ ë¯¼í•  í•„ìš” ì—†ì–´ìš”! í•œ ë°©ì— í•´ê²°
- ë” ì´ìƒ ë¶ˆí¸í•˜ê²Œ ì‚´ í•„ìš” ì—†ìŠµë‹ˆë‹¤!
- ë‹¹ì‹ ë„ ê²ªì–´ë³¸ ê·¸ ë¶ˆí¸í•¨, ì´ì œ í•´ê²°!
- í›„íšŒ ì—†ëŠ” ì„ íƒ, ì§€ê¸ˆ ë°”ë¡œ ê²½í—˜í•˜ì„¸ìš”!

4. ë§ˆì§€ë§‰ í›„í‚¹ ì˜ìƒ (ì˜ìƒ ëê¹Œì§€ í‘œì‹œ)
- ì§€ê¸ˆ í´ë¦­í•˜ë©´ ì¶”ê°€ í• ì¸!
- ë†“ì¹˜ë©´ í›„íšŒ! ì§€ê¸ˆ í™•ì¸í•˜ì„¸ìš”.
- ì¬ê³ ê°€ ì–¼ë§ˆ ë‚¨ì§€ ì•Šì•˜ì–´ìš”! ì„œë‘˜ëŸ¬ì£¼ì„¸ìš”.
- í• ì¸ì€ ì˜ˆê³  ì—†ì´ ì¢…ë£Œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëŠ¦ê¸° ì „ì— í™•ì¸í•˜ì„¸ìš”.
- í•œì • ìˆ˜ëŸ‰! ì§€ê¸ˆ êµ¬ë§¤í•˜ì„¸ìš”.
- ì˜¤ëŠ˜ë§Œ íŠ¹ê°€! ì§€ê¸ˆ ë°”ë¡œ í™•ì¸í•˜ì„¸ìš”.
- êµ¬ë§¤í•˜ëŸ¬ ê°€ê¸° ì „ì—, í• ì¸ í˜œíƒì„ í™•ì¸í•˜ì„¸ìš”!
- ì§€ê¸ˆ í´ë¦­í•˜ë©´ ë¬´ë£Œ ë°°ì†¡ í˜œíƒ!
- ì´ ì œí’ˆ, í’ˆì ˆë˜ê¸° ì „ì— ì¡ìœ¼ì„¸ìš”!
- ì´ì œ ì‚´ê¹Œ ë§ê¹Œ ê³ ë¯¼í•  ì‹œê°„ ì—†ìŠµë‹ˆë‹¤!
1- ì´ˆë¼ë„ ëŠ¦ìœ¼ë©´ í’ˆì ˆ! ì„œë‘˜ëŸ¬ì£¼ì„¸ìš”!

## caption:
ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ì€ ì• í”Œì˜ ìµœì‹  ë…¸íŠ¸ë¶ ë§¥ë¶ í”„ë¡œ 16 M4ë¥¼ ì†Œê°œí•´ë“œë¦´ê²Œìš”.
16ì¸ì¹˜ ë‚˜ë…¸ í…ìŠ¤ì²˜ ë””ìŠ¤í”Œë ˆì´ë¥¼ íƒ‘ì¬í•´ ëˆˆë¶€ì‹¬ì„ ìµœì†Œí™”í•˜ê³ , ì–´ë–¤ í™˜ê²½ì—ì„œë„ ì„ ëª…í•œ í™”ë©´ì„ ì œê³µí•©ë‹ˆë‹¤. ë•ë¶„ì— ì‹¤ë‚´ëŠ” ë¬¼ë¡  ì¹´í˜ë‚˜ ì•¼ì™¸ì—ì„œë„ í¸ì•ˆí•˜ê²Œ ì‘ì—…í•  ìˆ˜ ìˆì–´ìš”.
ìµœì‹  M4 ì‹œë¦¬ì¦ˆ ì¹©ì´ íƒ‘ì¬ë˜ì–´ ì´ì „ ëª¨ë¸ë³´ë‹¤ ìµœëŒ€ 3.5ë°° í–¥ìƒëœ ì„±ëŠ¥ì„ ì œê³µí•˜ë©°, ì˜ìƒ í¸ì§‘, ê·¸ë˜í”½ ë””ìì¸ ë“± ê³ ì‚¬ì–‘ ì‘ì—…ë„ ë¶€ë“œëŸ½ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°•ë ¥í•œ ì„±ëŠ¥ ë•ë¶„ì— ë©€í‹°íƒœìŠ¤í‚¹ë„ ë”ìš± íš¨ìœ¨ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆì–´ìš”.
ë˜í•œ, ìƒˆë¡œìš´ ì¬ë”ë³¼íŠ¸ 5 í¬íŠ¸ë¥¼ í†µí•´ ìµœëŒ€ 120Gb/sì˜ ì´ˆê³ ì† ì „ì†¡ ì†ë„ë¥¼ ì§€ì›í•´ ëŒ€ìš©ëŸ‰ íŒŒì¼ë„ ë¹ ë¥´ê²Œ ì „ì†¡í•  ìˆ˜ ìˆì–´ ì‘ì—… íš¨ìœ¨ì´ ê·¹ëŒ€í™”ë©ë‹ˆë‹¤.
macOS Sequoia 15.1ì„ í†µí•´ AI ê¸°ë°˜ ë„êµ¬ì™€ í–¥ìƒëœ ì‹œë¦¬, ì•„ì´í° ë¯¸ëŸ¬ë§, ê°œì¸í™”ëœ ê³µê°„ ìŒí–¥ ë“± ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ê²½í—˜í•  ìˆ˜ ìˆìœ¼ë©°, ë”ìš± ì§ê´€ì ì´ê³  í¸ë¦¬í•œ ì‚¬ìš© í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤.
ê°•ë ¥í•œ ì„±ëŠ¥ê³¼ í˜ì‹ ì ì¸ ê¸°ìˆ ì„ ê°–ì¶˜ ë§¥ë¶ í”„ë¡œ 16 M4ë¡œ ë”ìš± ë¹ ë¥´ê³  íš¨ìœ¨ì ì¸ ì‘ì—…ì„ ê²½í—˜í•´ë³´ì„¸ìš”.

ì•ˆë…•í•˜ì„¸ìš”! ì˜¤ëŠ˜ì€ ì§‘ì—ì„œ ì¹´í˜ ê°ì„±ì„ ëŠë‚„ ìˆ˜ ìˆëŠ” ë„¤ìŠ¤ì¹´í˜ ëŒì²´êµ¬ìŠ¤í†  ì§€ë‹ˆì˜¤ Së¥¼ ì†Œê°œí•´ë“œë¦´ê²Œìš”.
ê°„í¸í•œ í„°ì¹˜ ì¡°ì‘ìœ¼ë¡œ ì›í•˜ëŠ” ì»¤í”¼ë¥¼ ë¹ ë¥´ê²Œ ì¶”ì¶œí•  ìˆ˜ ìˆì–´ ë°”ìœ ì•„ì¹¨ì—ë„ ë¶€ë‹´ ì—†ì´ ì¦ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìµœëŒ€ 15ë°”ì˜ ê³ ì•• ì¶”ì¶œ ì‹œìŠ¤í…œ ë•ë¶„ì— ê¹Šê³  í’ë¶€í•œ ì•„ë¡œë§ˆì™€ ë¶€ë“œëŸ¬ìš´ í¬ë ˆë§ˆë¥¼ ì™„ì„±í•´ ë”ìš± ë§›ìˆëŠ” ì»¤í”¼ë¥¼ ê²½í—˜í•  ìˆ˜ ìˆì–´ìš”.
ì§„í•œ ì»¤í”¼ê°€ í•„ìš”í•  ë• ì—ìŠ¤í”„ë ˆì†Œ ë¶€ìŠ¤íŠ¸ ëª¨ë“œë¥¼ í™œìš©í•´ ë”ìš± ê¹Šê³  ê°•ë ¬í•œ í’ë¯¸ë¥¼ ëŠë‚„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 4ë‹¨ê³„ ì˜¨ë„ ì¡°ì ˆ ê¸°ëŠ¥ì´ íƒ‘ì¬ë˜ì–´ ìˆì–´ ì—¬ë¦„ì—ëŠ” ì•„ì´ìŠ¤ ì»¤í”¼, ê²¨ìš¸ì—ëŠ” ë”°ëœ»í•œ ë¼ë–¼ê¹Œì§€ ê¸°í˜¸ì— ë§ì¶° ì‚¬ê³„ì ˆ ë‚´ë‚´ ì™„ë²½í•œ ì»¤í”¼ íƒ€ì„ì„ ì¦ê¸¸ ìˆ˜ ìˆì–´ìš”.
ë˜í•œ, 1ë¶„ ë™ì•ˆ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ìë™ìœ¼ë¡œ ì „ì›ì´ êº¼ì§€ëŠ” ì—ì½” ëª¨ë“œë¡œ ì—ë„ˆì§€ë¥¼ ì ˆì•½í•  ìˆ˜ ìˆì–´ ë”ìš± ì‹¤ìš©ì ì…ë‹ˆë‹¤.
ì–¸ì œë“  ì§‘ì—ì„œ ê°„í¸í•˜ê²Œ ì™„ë²½í•œ ì»¤í”¼ í•œ ì”ì„ ì¦ê¸¸ ìˆ˜ ìˆëŠ” ë„¤ìŠ¤ì¹´í˜ ëŒì²´êµ¬ìŠ¤í†  ì§€ë‹ˆì˜¤ Së¡œ ë”ìš± í’ì„±í•œ ì»¤í”¼ ë¼ì´í”„ë¥¼ ê²½í—˜í•´ë³´ì„¸ìš”!

## title:
- ì´ í›„ë“œí‹° ì—†ìœ¼ë©´ ë´„ ì½”ë”” ì™„ì„± ëª» í•œë‹¤ê³ ?!ğŸ”¥ 
- ìš”ì¦˜ ìŠ¤íŠ¸ë¦¿ íŒ¨ì…˜ í•µì‹¬í…œ! ì´ê±° í•˜ë‚˜ë©´ ë! 
- ì§„ì§œ ìŠ¤íƒ€ì¼ ì‹ ê²½ ì“°ëŠ” ì‚¬ëŒë“¤ì€ ë‹¤ ì´ê±° ì…ìŒ 
- í›„ë“œí‹° í•˜ë‚˜ë¡œ ë¶„ìœ„ê¸° ì´ë ‡ê²Œ ë‹¬ë¼ì§„ë‹¤ê³ ? ğŸ˜³ 
- ì†”ì§íˆ ì´ê±° í•˜ë‚˜ë§Œ ìˆìœ¼ë©´ ì½”ë”” ëë‚œë‹¤! 
- í›„ë“œí‹° ì…ëŠ” ì‚¬ëŒ í•„ìˆ˜ ì‹œì²­! í›„ë“œí‹° ê³ ë¥´ëŠ” ë²• 
- ë‚¨ì¹œë£©, ì—¬ì¹œë£© ì´ê±° í•˜ë‚˜ë©´ ê²Œì„ ëğŸ”¥ 
- ì˜¬ë´„ íŠ¸ë Œë“œ í›„ë“œí‹°! ìŠ¤íƒ€ì¼ë§ ê¿€íŒ ëŒ€ë°©ì¶œ 
- í™í•œ ì‚¬ëŒë“¤ì€ ë‹¤ ì…ëŠ”ë‹¤ëŠ” ê·¸ í›„ë“œí‹° 
- ìŠ¤íŠ¸ë¦¿ íŒ¨ì…˜ í•„ìˆ˜í…œ! í›„ë“œí‹° ì¶”ì²œ Best 5 

## description:
- ğŸ”¥ ê°•í•œ í˜¸ê¸°ì‹¬ ìœ ë°œí˜•
- ì´ê±° ì—†ìœ¼ë©´ ì˜¬ë´„ ì½”ë”” ëë‚¬ë‹¤ê³  ë´ì•¼ì§€...ğŸ”¥ > {base_url}\n\n\n{name}
- íŒ¨ì…˜ ì¢€ ì‹ ê²½ ì“°ëŠ” ì• ë“¤ì€ ë‹¤ ìƒ€ë‹¤ëŠ”ë°? ğŸ¤” > {base_url}\n\n\n{name}
- ìš”ì¦˜ ì´ê±° ì—†ì´ ìŠ¤íƒ€ì¼ë§ ëª»í•œë‹¤ë˜ë°...ğŸ˜ > {base_url}\n\n\n{name}
- ê·¸ëƒ¥ í¸í•´ì„œ ì…ì—ˆëŠ”ë° ë¶„ìœ„ê¸° ë¯¸ì³¤ë‹¤ê³  í•¨;; > {base_url}\n\n\n{name}
- ì´ê±° í’ˆì ˆëœë‹¤ëŠ” ì–˜ê¸° ë“¤ì—ˆëŠ”ë° ì‚¬ì‹¤ì„?ğŸ˜¨ > {base_url}\n\n\n{name}

ğŸ”¥ ìœ í–‰ & íŠ¸ë Œë“œ ë°˜ì˜í˜•
- ì´ê±° ìš”ì¦˜ í™í•œ ì• ë“¤ì€ ë‹¤ ì…ëŠ”ë‹¤ë©°? ğŸ˜ > {base_url}\n\n\n{name}
- ìŠ¤íŠ¸ë¦¿ë£© ì…ëŠ” ì• ë“¤ ì´ê±° ë‹¤ ìƒ€ë”ë¼;; > {base_url}\n\n\n{name}
- íŒ¨ì…˜ í”¼í”Œ ì‚¬ì´ì—ì„œ ìš”ì¦˜ ì œì¼ í•«í•œ í›„ë“œí‹° > {base_url}\n\n\n{name}
- ì—°ì˜ˆì¸ë“¤ì´ ìš”ì¦˜ ì´ê±° ì…ê³  ë‚˜ì˜¨ë‹¤ê³  í•¨!! > {base_url}\n\n\n{name}
- íŠ¸ë Œë“œ ì¢€ ì‹ ê²½ ì“°ëŠ” ì‚¬ëŒë“¤ì€ ë‹¤ ìƒ€ë‹¤ëŠ”ë°? > {base_url}\n\n\n{name}

ğŸ”¥ ê³µê° ìœ ë°œí˜• (ì¹œêµ¬/ì—°ì¸/ì¼ìƒ ì—°ê³„)
- ì´ê±° ì…ê³  ê°”ëŠ”ë° ì¹œêµ¬ë“¤ì´ ë¸Œëœë“œ ì–´ë””ëƒê³  ë¬¼ì–´ë´„ > {base_url}\n\n\n{name}
- í›„ë“œí‹° í•˜ë‚˜ ìƒ€ì„ ë¿ì¸ë° ìŠ¤íƒ€ì¼ ì™œ ì´ë ‡ê²Œ ë‹¬ë¼ì§? > {base_url}\n\n\n{name}
- ë°ì´íŠ¸ë£© ê³ ë¯¼ ëë‚¬ë‹¤, ê·¸ëƒ¥ ì´ê±° ì…ìœ¼ë©´ ë¨ > {base_url}\n\n\n{name}
- ì´ê±° ì…ê³  ë‚˜ê°”ë”ë‹ˆ ì—¬ì¹œì´ ê·€ì—½ëŒ€...ğŸ«£ > {base_url}\n\n\n{name}
- ì´ê±° ì…ê³  ì‚¬ì§„ ì°ìœ¼ë©´ ì¸ìƒìƒ· ë³´ì¥ë¨ğŸ“¸ > {base_url}\n\n\n{name}

ğŸ”¥ ìœ ë¨¸ & ìê·¹í˜•
- ì´ê±° ì‚¬ë©´ íŒ¨ì…˜ ì¸ì‹¸ ë˜ëŠ” ê±° ë§ìŒ? > {base_url}\n\n\n{name}
- ì†”ì§íˆ ì´ê±° ì•ˆ ì‚¬ëŠ” ì‚¬ëŒë“¤ ì´í•´ ì•ˆ ê° > {base_url}\n\n\n{name}
- ì´ê±° í’ˆì ˆë˜ë©´ ëˆˆë¬¼ ë‚œë‹¤ ì§„ì§œ... > {base_url}\n\n\n{name}
- ì§„ì§œ ìŠ¤íƒ€ì¼ì— ê´€ì‹¬ ìˆëŠ” ì‚¬ëŒë“¤ì€ ì´ê±° ë‹¤ ìƒ€ë‹¤ëŠ”ë°? > {base_url}\n\n\n{name}
- ì´ê±° ì‚¬ê³  í›„ë“œí‹° ìœ ëª©ë¯¼ íƒˆì¶œí–ˆë‹¤ > {base_url}\n\n\n{name}

## hashtag:
#íŒ¨ì…˜ìŠ¤íƒ€ê·¸ë¨ #ìš´ë™ë³µì¶”ì²œ #ootd #ì¼ìƒë£© #ìŠ¤í¬í‹°ë£© #ì—¬ìì˜· #ìŠ¤íƒ€ì¼ë§ #ì‡¼í•‘
#ì¸ìƒí…œ #ì‚´ë¦¼ê¿€í…œ #ë‚´ëˆë‚´ì‚° #ì§‘ê¾¸ë¯¸ê¸° #í¸ë¦¬ë¯¸ì—„ #í•„ìˆ˜í…œ #ì‚´ë¦¼í…œ #ìë™ì²­ì†Œ

[Notes]
- ì˜ˆì‹œ ì¶œë ¥ì„ ì°¸ê³ í•  ê²ƒ.
- 20ëŒ€, 30ëŒ€ ì»¤ë®¤ë‹ˆí‹° ë¬¸í™”ë¥¼ ê¹Šì´ ì´í•´í•˜ê³  ì´ë¥¼ ë°˜ì˜í•©ë‹ˆë‹¤.
- íŠ¸ë Œë””í•œ ìš”ì†Œë“¤ì„ ì •í™•íˆ íŒŒì•…í•˜ê³  ì ìš©í•˜ëŠ” ë° ì¤‘ì ì„ ë‘¡ë‹ˆë‹¤.
"""
    prompt = replace_prompt_with_data(prompt, data)

    prompt = prompt.replace("CAPTION_COUNT", str(len(images)))

    content = [{"type": "text", "text": prompt}]
    for image in images:
        content.append({"type": "image_url", "image_url": {"url": image}})

    response_schema = {
        "name": "response_schema",
        "strict": True,
        "schema": {
            "type": "object",
            "properties": {
                "response": {
                    "type": "object",
                    "properties": {
                        "hooking": {
                            "type": "array",
                            "description": "hooking message",
                            "items": {"type": "string"},
                        },
                        "caption": {
                            "type": "string",
                            "description": "caption for making video.",
                        },
                        "title": {
                            "type": "string",
                            "description": "Title of the response.",
                        },
                        "description": {
                            "type": "string",
                            "description": "Description text displayed separately from the image on platforms like YouTube, Instagram, and TikTok.",
                        },
                        "hashtag": {
                            "type": "string",
                            "description": "Hashtag associated with the response.",
                        },
                    },
                    "required": [
                        "hooking",
                        "caption",
                        "title",
                        "description",
                        "hashtag",
                    ],
                    "additionalProperties": False,
                }
            },
            "required": ["response"],
            "additionalProperties": False,
        },
    }

    return call_chatgpt(content, response_schema, post_id)


def call_chatgpt_create_blog(images=[], data={}, post_id=0):
    prompt = """ì—…ë¡œë“œëœ ì´ë¯¸ì§€ë“¤ì„ ì°¸ê³ í•˜ì—¬, ì œí’ˆì˜ ë‹¤ìŒ ì„¸ë¶€ ì •ë³´ë¥¼ ë°˜ì˜í•œ **ë¸”ë¡œê·¸ ê²Œì‹œê¸€**ì„ ì‘ì„±í•´ ì£¼ì„¸ìš”.

ì œí’ˆ ê´€ë ¨ ì •ë³´:
- ì œí’ˆëª…: {name}
- ê°€ê²©: {price}
- ì œí’ˆ ì„¤ëª…: {description}
- íŒë§¤ì²˜: {store_name}
- ì œí’ˆ ë§í¬: {base_url}
- ì œí’ˆ ì†Œê°œ: {text}

ì¡°ê±´:
- ê²Œì‹œê¸€ì€ ì•½ 1200ì ì •ë„ë¡œ ì‘ì„±í•´ ì£¼ì„¸ìš”.
- ì œí’ˆì— ëŒ€í•œ ìì„¸í•œ ì„¤ëª…, ì¥ì , ì‚¬ìš© ë°©ë²• ë“±ì„ í¬í•¨í•˜ì—¬ ë…ìê°€ ê´€ì‹¬ì„ ê°€ì§ˆ ìˆ˜ ìˆë„ë¡ ì¹œê·¼í•˜ê³  ì„¤ë“ë ¥ ìˆê²Œ ì‘ì„±í•´ ì£¼ì„¸ìš”.
- **ê²Œì‹œê¸€ì€ ë‘ ê°€ì§€ í˜•ì‹ìœ¼ë¡œ ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤:**
  1. **`docx_content`**: **ìˆœìˆ˜í•œ ë¬¸ìì—´(plain text) ë° `IMAGE_URL_index`ë¥¼ í¬í•¨í•œ ë°°ì—´ í˜•ì‹**ìœ¼ë¡œ ì œê³µ.
  2. **`content`**: **HTML í˜•ì‹**ìœ¼ë¡œ ì œê³µ.
- ê²Œì‹œê¸€ ìƒë‹¨ì— ì‚¬ìš©ìì˜ ê´€ì‹¬ì„ ëŒ ìˆ˜ ìˆëŠ” **ë§¤ë ¥ì ì¸ ì œëª©**ì„ í¬í•¨í•´ ì£¼ì„¸ìš”.
- ì œí’ˆì˜ ì´ë¯¸ì§€ëŠ” ì—…ë¡œë“œëœ ì´ë¯¸ì§€ì—ì„œ ì„ íƒí•˜ì—¬, ì ì ˆí•œ ìœ„ì¹˜ì— ì‚½ì…í•´ ì£¼ì„¸ìš”.  
  - **`docx_content`ì—ì„œëŠ” IMAGE_URL_index í˜•ì‹(`"IMAGE_URL_0"`, `"IMAGE_URL_1"`, ...)ìœ¼ë¡œ í‘œí˜„**  
  - **`content`ì—ì„œëŠ” ë™ì¼í•œ ìœ„ì¹˜ì— `<p>IMAGE_URL_index</p>` í˜•íƒœë¡œ í‘œí˜„**  
- ë³¸ë¬¸ ë‚´ìš©ê³¼ í•¨ê»˜, ë³¸ë¬¸ ë‚´ìš©ì„ ìš”ì•½í•œ **ìš”ì•½ë¬¸(`summarize`)**ë„ ìƒì„±í•´ ì£¼ì„¸ìš”.
- **ìš”ì•½ë¬¸ì€ 300~350ì ì´ë‚´ë¡œ ì‘ì„±í•´ ì£¼ì„¸ìš”.**
- **ìš”ì•½ì˜ ë‚´ìš©ì€ ë°˜ë“œì‹œ í•œêµ­ì–´ë¡œ ì‘ì„±ë˜ì–´ì•¼ í•˜ë©°, ê²°ê³¼ëŠ” `response_schema` í˜•ì‹ì— ë§ì¶° ë°˜í™˜ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.**

---

### **ğŸ”¹ Output Format (JSON)**
```json
{
    "title": "ë¸”ë¡œê·¸ ê²Œì‹œê¸€ ì œëª©",
    "summarize": "ìš”ì•½ëœ ë‚´ìš©",
    "docx_content": [
        "ì œí’ˆì˜ íŠ¹ì§• ë° ì¥ì ì— ëŒ€í•´ ì„¤ëª…í•˜ëŠ” ì²« ë²ˆì§¸ ë‹¨ë½",
        "IMAGE_URL_0",
        "ì œí’ˆ ì‚¬ìš© ë°©ë²•ì— ëŒ€í•œ ì„¤ëª…ì´ í¬í•¨ëœ ë‘ ë²ˆì§¸ ë‹¨ë½",
        "IMAGE_URL_1",
        "ì œí’ˆì„ êµ¬ë§¤í•˜ëŠ” ë°©ë²•ê³¼ íŒë§¤ì²˜ ì •ë³´",
        "IMAGE_URL_2"
    ],
    "content": "<h1>ë¸”ë¡œê·¸ ê²Œì‹œê¸€ ì œëª©</h1>
                <p>ì œí’ˆì˜ íŠ¹ì§• ë° ì¥ì ì— ëŒ€í•´ ì„¤ëª…í•˜ëŠ” ì²« ë²ˆì§¸ ë‹¨ë½</p>
                <p><img src="IMAGE_URL_0" alt="{name}"></p>
                <p>ì œí’ˆ ì‚¬ìš© ë°©ë²•ì— ëŒ€í•œ ì„¤ëª…ì´ í¬í•¨ëœ ë‘ ë²ˆì§¸ ë‹¨ë½</p>
                <p><img src="IMAGE_URL_1" alt="{name}"></p>
                <p>ì œí’ˆì„ êµ¬ë§¤í•˜ëŠ” ë°©ë²•ê³¼ íŒë§¤ì²˜ ì •ë³´</p>
                <p><img src="IMAGE_URL_2" alt="{name}"></p>"
}
"""
    prompt = prompt.replace("COUNT_IMAGE", str(len(images)))

    prompt = replace_prompt_with_data(prompt, data)

    content = [{"type": "text", "text": prompt}]
    for image in images:
        content.append({"type": "image_url", "image_url": {"url": image}})

    response_schema = {
        "name": "response_schema",
        "schema": {
            "type": "object",
            "properties": {
                "response": {
                    "type": "object",
                    "properties": {
                        "title": {
                            "type": "string",
                            "description": "The title of the response.",
                        },
                        "summarize": {
                            "type": "string",
                            "description": "A summary or brief overview of the content.",
                        },
                        "docx_content": {
                            "type": "array",
                            "description": "The content will be written to the docx file.",
                            "items": {"type": "string"},
                        },
                        "content": {
                            "type": "string",
                            "description": "The main content of the response.",
                        },
                    },
                    "required": ["title", "summarize", "docx_content", "content"],
                    "additionalProperties": False,
                }
            },
            "required": ["response"],
            "additionalProperties": False,
        },
        "strict": True,
    }

    return call_chatgpt(content, response_schema, post_id)


def call_chatgpt_create_social(images=[], data={}, post_id=0):
    prompt = """[ì—­í• ]
ë‹¹ì‹ ì€ ë°”ì´ëŸ´ ë§ˆì¼€íŒ… ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì£¼ì–´ì§„ ìƒí’ˆ ë§í¬ë¥¼ í†µí•´ MZ ì„¸ëŒ€ê°€ ê³µê°í•  ìˆ˜ ìˆë„ë¡ ìµœì‹  ë°ˆì„ ë°˜ì˜í•œ SNS ì½˜í…ì¸ ë¥¼ ì œì‘í•˜ì„¸ìš”. ìœ í–‰ì–´ì™€ ì¬ì¹˜ ìˆëŠ” ë§íˆ¬ë¥¼ ì ê·¹ì ìœ¼ë¡œ í™œìš©í•˜ì„¸ìš”.

[ì…ë ¥ ì •ë³´]
ì œí’ˆëª…: {name}
ê°€ê²©: {price}
ì œí’ˆ ì„¤ëª…: {description}
íŒë§¤ì²˜: {store_name}
ì œí’ˆ ë§í¬: {base_url}
ì´ë¯¸ì§€ ê°œìˆ˜: {image_count}
ì œí’ˆ ì†Œê°œ: {text}

{name}ì€ ì œí’ˆ ì´ë¦„ë§Œ ì¶”ì¶œí•´ì„œ ì‚¬ìš©í•´ì£¼ì„¸ìš”

[ìƒì„± ì¡°ê±´]
**caption**: 
  - ì²« ë²ˆì§¸ ì´ë¯¸ì§€: ì œí’ˆì„ ì§ì ‘ ì–¸ê¸‰í•˜ì§€ ì•Šê³  í˜¸ê¸°ì‹¬ì„ ìœ ë°œí•˜ëŠ” ì–´ê·¸ë¡œì„± ë¬¸êµ¬ë¡œ ì‘ì„±
  - ë‘ ë²ˆì§¸~{image_count}ë²ˆì§¸ ì´ë¯¸ì§€: ì œí’ˆì˜ í•µì‹¬ í¬ì¸íŠ¸ë¥¼ ìœ í–‰í•˜ëŠ” ë°ˆì´ë‚˜ íŠ¸ë Œë“œì— ë§ì¶˜ ë§íˆ¬ë¡œ ì¬ë¯¸ìˆê²Œ ì†Œê°œ
  - ì´ë¯¸ì§€ ê°œìˆ˜: ìµœì†Œ 4ì¥ ~ ìµœëŒ€ 8ì¥
  - í•œ ì¥ì˜ ì´ë¯¸ì§€ì— ë¬¸ì¥ 2ì¤„ ì‘ì„±, 1ì¤„ì— ë„ì–´ì“°ê¸° í¬í•¨ ê¸€ììˆ˜ ìµœëŒ€ 17ì
  - ë‘ ë²ˆì§¸~{image_count}ë²ˆì§¸ ì´ë¯¸ì§€ ë¬¸ì¥ êµ¬ì„±ì‹œ ì—°ê²°ì„± ìˆê²Œ ì‘ì„±
  - 20~30ëŒ€ê°€ ê³µê°í•  ìˆ˜ ìˆëŠ” ìœ í–‰ì–´ì™€ ìµœì‹  ë°ˆ ì ê·¹ ë°˜ì˜
  - ë§íˆ¬: í•œêµ­ MZì„¸ëŒ€ê°€ ì‹¤ì œ SNSì—ì„œ ì“°ëŠ” ë§íˆ¬ë¡œ ìì—°ìŠ¤ëŸ½ê²Œ, í•œêµ­ì¸ì´ ì‹¤ì œ ëŒ€í™”ì—ì„œ ì“°ëŠ” ìì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„ìœ¼ë¡œ, ì¸ìœ„ì ì¸ ëŠë‚Œì´ ë“¤ì§€ ì•Šë„ë¡ íŠ¸ë Œë””í•œ ë§íˆ¬ì™€ ìœ í–‰ì–´ë¥¼ ë°˜ì˜
  - ë¬¸êµ¬ì— ì´ëª¨í‹°ì½˜ ì ˆëŒ€ í¬í•¨í•˜ì§€ ì•ŠìŒ
  - ë°˜ë“œì‹œ "[ì˜ˆì‹œ ì¶œë ¥]ì˜ ##description"ì„ ì°¸ê³ í•´ì„œ ì‘ì„±í•  ê²ƒ

**description**: 
  - ë¬¸ì¥ ìµœëŒ€ 2ì¤„ë¡œ ì‘ì„±
  - ì¤„ë°”ê¿ˆ í›„ "êµ¬ë§¤ë§í¬ğŸ‘‰: {base_url}" ì´ ë¬¸ì¥ ë¬´ì¡°ê±´ í‘œì‹œ 
  - êµ¬ë§¤ë§í¬ ë‹¤ìŒì— ì¤„ë°”ê¿ˆ í›„ "{name}" ë¬´ì¡°ê±´ í¬í•¨
  - ë¬¸ì¥ì„ ì •í™•í•˜ê²Œ ëë‚´ì§€ ë§ê³ , ë§ ëì„ íë¦´ ê²ƒ 

**hashtag**: 
  - {name} ë¬´ì¡°ê±´ í¬í•¨ 
  - ì œí’ˆê³¼ ê´€ë ¨ëœ í‚¤ì›Œë“œ í•´ì‹œíƒœê·¸ í¬í•¨
  - ì œí’ˆì˜ ê³ ê°ì¸µì´ ê´€ì‹¬ ê°€ì§ˆë§Œí•œ ê´€ë ¨ í•´ì‹œíƒœê·¸ ë°˜ì˜
  - ê°œìˆ˜ëŠ” 10ê°œ ì´í•˜ë¡œ ì‘ì„±

[ì˜ˆì‹œ ì¶œë ¥]
## caption:
[ì²« ë²ˆì§¸ ì´ë¯¸ì§€ - ë°”ì´ëŸ´ ë¬¸êµ¬(ì•„ë˜ ì˜ˆì‹œê°™ì€ í˜•íƒœë¡œ í•˜ë‚˜ë§Œ ì¶œë ¥)]:
í•˜ë¹„ì¸ë° ì…ì„ ì˜·ì´ ì—†ì–´ì„œ ë§Œë“¤ì—ˆë‹¤ëŠ” ì „ì„¤ì˜ ë°”ì§€
ì´ê±° ì‚¬ë©´ ê³„ì† ì‚¬ê²Œ ë ê±¸ìš”?

[ë‘ ë²ˆì§¸ ì´ë¯¸ì§€ - ë°”ì´ëŸ´ ì„¤ëª…(ì•„ë˜ ì˜ˆì‹œê°™ì€ í˜•íƒœë¡œ í•˜ë‚˜ë§Œ ì¶œë ¥)]:
ì•„ë§ˆ ë‚˜ì™€ ê°™ì€ ê³ ë¯¼ì„ í•˜ëŠ” ë™ì§€ë“¤ì´ ë§ì„ê±°ì•¼!
ë°”ë¡œ {name}! ê°€ê²© êµ¿: {price} ê·¸ë¦¬ê³  ì¶©ê²©ì ì¸ê²Œ â†’

[ì„¸ ë²ˆì§¸ ì´ë¯¸ì§€ - ë°”ì´ëŸ´ ì„¤ëª…(ì•„ë˜ ì˜ˆì‹œê°™ì€ í˜•íƒœë¡œ í•˜ë‚˜ë§Œ ì¶œë ¥)]:
ë‹µë‹µí•¨ ì—†ì´ í¸í•˜ê²Œ! ì••ë°•ìŠ¤íƒ€í‚¹ë„ ì‹ ì„ ìˆ˜ ìˆë„ë¡ í†µ ë„“ê²Œ!
ê°€ê²©ë„ ì¢‹ì€ë° ê±´ê°•í•œ ì´ˆì§€ ë°©ëª©ìœ !! ì°í•˜ê³  ê³ ì†Œí•œ ë§›!

[ë„¤ ë²ˆì§¸ ì´ë¯¸ì§€ - ë°”ì´ëŸ´ ì„¤ëª…(ì•„ë˜ ì˜ˆì‹œê°™ì€ í˜•íƒœë¡œ í•˜ë‚˜ë§Œ ì¶œë ¥)]:
ë‚´ê°€ ì œì¼ ì›í–ˆë˜ ê±´ ë”±í•˜ë‚˜! ë°°ìª¼ì„ ì—†ëŠ” ë°´ë“œ! (í—ˆë¦¬ê°€ ì»¤ë„ ë°°ìª¼ì´ëŠ”ê±´ ìª¼ì´ê±°ë“ ?ì´ê±° ì•„ëŠ”ì‚¬ëŒ?ã…‹ã…‹ã…‹)
{store_name} í›„ê¸° nì²œê°œ {name}

[ë‹¤ì„¯ ë²ˆì§¸ ì´ë¯¸ì§€ - ë°”ì´ëŸ´ ì„¤ëª…(ì•„ë˜ ì˜ˆì‹œê°™ì€ í˜•íƒœë¡œ í•˜ë‚˜ë§Œ ì¶œë ¥)]:
ì˜ì§€ì˜ í•˜ë¹„!! ë¼ë²¨ ì œì‘ë¶€í„° ë‹¤í•¨! í˜ë“¤ê²Œ íƒ„ìƒí•œ ìš°ë¦¬ì˜ êµë³µë°”ì§€ {name}
ë­˜ í•´ì¤˜ë„ ì˜ ì•ˆ ë¨¹ëŠ” ì…ì§§ì€ ë‘˜ì§¸ê°€ ì½”ë°•ê³  ë¨¹ì–´ìš”ã…‹ã…‹ã…‹

## description:
ğŸ”¥ ê°•í•œ í˜¸ê¸°ì‹¬ ìœ ë°œí˜•
í•„í„° ì•ˆ ì“´ ê±° ë§ì•„ìš”. ê·¸ëƒ¥ ì´ ì„¸ëŸ¼ ë•ë¶„ì„. > {base_url}
ë¬¼ê´‘? ì•„ë‹ˆ, ì´ê±´ ëŒ€ê¸°ê¶Œ ëš«ê³  ì˜¬ë¼ê°€ëŠ” ë¹›ê´‘. > {base_url}
ìê¸° ì „ì— ë°”ë¥´ê³  ìë©´ í”¼ë¶€ ë¦¬ì…‹ë¨. 100% ì‹¤í™”. > {base_url}
ì´ê±° ë°”ë¥´ë©´ ê±°ìš¸ ì…€ì¹´ í•„í„° êº¼ì•¼ ë¨. ì™œëƒë©´... > {base_url}
ì´ê²Œ ëœë‹¤ê³ ?â€ ì‹¶ì—ˆëŠ”ë° ì§„ì§œ ë˜ë”ë¼;; > {base_url}
ì§‘ë“¤ì´ ì„ ë¬¼ ê³ ë¯¼í•  í•„ìš” ì—†ì´ ì´ê±° ì‚¬ë©´ ë¨. > {base_url}

ğŸ”¥ ìœ í–‰ & íŠ¸ë Œë“œ ë°˜ì˜í˜•
2025ë…„, ì´‰ì´‰í•œ í”¼ë¶€ê°€ ëŒ€ì„¸ë¼ë˜ë°? ë‚œ ì´ë¯¸ íƒ‘ìŠ¹ ì™„ë£Œ. > {base_url}
ì´ê±° ì—†ìœ¼ë©´ ê¸€ë¡œìš° ìŠ¤í‚¨ íŠ¸ë Œë“œ ëª» ë”°ë¼ê°. > {base_url}
ìš”ì¦˜ ê¾¸ì•ˆê¾¸ ìŠ¤í‚¨ì€ ì´ê±° í•˜ë‚˜ë¡œ ì™„ì„±ì´ë¼ë˜ë°? > {base_url}
ì´ì œ ë‹¤ë“¤ ì²­ì†Œ ì•ˆ í•œë‹¤ê³ ? ì´ìœ ê°€ ìˆìŒ > {base_url}
ìš”ì¦˜ í•˜ì´í…Œí¬ ë¼ì´í”„ ì‚´ë ¤ë©´ í•„ìˆ˜í…œ > {base_url}

ğŸ”¥ ê³µê° ìœ ë°œí˜• (ì¹œêµ¬/ì—°ì¸/ì¼ìƒ ì—°ê³„)
í”¼ë¶€ ê³ ë¯¼? ë‚´ ì¹œêµ¬ë„ ì´ê±° ì“°ê³  í•´ê²°í–ˆëŒ€. > {base_url}
ì´ê±° ì‚¬ê³  ë‹¤ë“¤ ì²­ì†Œ ì–´ë–»ê²Œ í•˜ëƒê³  ë¬¼ì–´ë³´ëŠ”ë°ìš”? > {base_url}
ì¹œêµ¬ë„¤ ê°”ë‹¤ê°€ ì²­ì†Œê¸° ë³´ê³  ë°˜í•´ì„œ ë°”ë¡œ ì‚¼ > {base_url}
ë‚¨ì¹œ ì§‘ ê°”ëŠ”ë° ë¨¼ì§€ 1ë„ ì—†ê¸¸ë˜ ì´ìœ  ë¬¼ì–´ë³´ë‹ˆê¹Œ ì´ê±°ì˜€ìŒ > {base_url}
ë¶€ëª¨ë‹˜ ì„ ë¬¼ë¡œ ë“œë ¸ëŠ”ë° ì¢‹ì•„í•˜ì‹¬ > {base_url}

ğŸ”¥ ê°ì„± & ë¯¸ë‹ˆë©€í•œ ê°ê°í˜•
ì¡°ìš©í•˜ì§€ë§Œ í™•ì‹¤í•œ ë³€í™” > {base_url}
ìŠ¤í‚¨ì¼€ì–´, ì‹¬í”Œí•œ ê²Œ ë‹µì´ë‹¤. > {base_url}
ê³µê°„ì— ìŠ¤ë©°ë“œëŠ” ë””ìì¸ > {base_url}
ë³´ì´ì§€ ì•ŠëŠ” ê¸°ìˆ ì´ ì§„ì§œë‹¤ > {base_url}
ê¸°ìˆ ì€ ë³´ì´ì§€ ì•Šì„ ë•Œ ë” ê°€ì¹˜ ìˆë‹¤ > {base_url}

ğŸ”¥ ë¦¬ë·° & ì¶”ì²œ ëŠë‚Œí˜•
ì›ë˜ ê´‘ê³  ì•ˆ ë¯¿ëŠ”ë°, ì´ê±´ ì§„ì§œ ì¶”ì²œí•¨ > {base_url}
ì‚¬ìš© í›„ê¸°: ì¸ìƒí…œ ë“±ê·¹ > {base_url}
í•œ í†µ ë‹¤ ì“°ê³  ì¬êµ¬ë§¤í•¨. ë‹µ ë‚˜ì™”ì§€? > {base_url}
ë¶€ëª¨ë‹˜ë„ ì¢‹ì•„í•˜ëŠ” ê°€ì „í…œ ì°¾ìŒ > {base_url}
ì¨ë³´ë‹ˆê¹Œ ë‹¤ë“¤ ì™œ ì¶”ì²œí•˜ëŠ”ì§€ ì•Œê² ìŒ > {base_url}

ğŸ”¥ ìœ ë¨¸ & ìê·¹í˜•
í•„í„°? í•„ìš” ì—†ìŒ. ê·¸ëƒ¥ ë‚´ í”¼ë¶€ê°€ ì´ ì •ë„ì„. > {base_url}
ì¸ìŠ¤íƒ€ ê°ì„± ë§ê³  í”¼ë¶€ ê°ì„±ë¶€í„° ì±™ê¸°ì > {base_url}
ìê³  ì¼ì–´ë‚¬ëŠ”ë° í”¼ë¶€ ìƒíƒœê°€ ë¯¸ì³¤ìŒ > {base_url}
ë‚˜ëŠ” ì•‰ì•„ ìˆê³  ì²­ì†Œê¸°ëŠ” ì¼í•¨. ì´ê²Œ ë§ì§€? > {base_url}
ë¡œë´‡ì²­ì†Œê¸° ì¼œë†“ê³  ë‚˜ëŠ” ë“œë¼ë§ˆ ì •ì£¼í–‰ ì¤‘ > {base_url}
â€œì´ê±° ì‚¬ê³  ë‚˜ì„œ ë°”ë‹¥ ë‹¦ì€ ì  ì—†ì–´â€ (ì§„ì§œì„) > {base_url}

ğŸ”¥ ê³„ì ˆ & íŠ¸ë Œë“œ í™œìš©í˜•
ë´„ë§ì´ ìŠ¤í‚¨ì¼€ì–´? ì´ê±° í•˜ë‚˜ë©´ ì¶©ë¶„ > {base_url}
ê³„ì ˆì´ ë°”ë€Œë©´ í”¼ë¶€ ë£¨í‹´ë„ ë‹¬ë¼ì ¸ì•¼ í•¨ > {base_url}
ë´„ í”¼ë¶€ ê³ ë¯¼? ë¯¸ë¦¬ ëŒ€ë¹„í•´ì•¼ í•¨ > {base_url}
í™©ì‚¬, ë¯¸ì„¸ë¨¼ì§€ ë§ì€ ë‚  í•„ìˆ˜í…œ > {base_url}
ë¯¸ì„¸ë¨¼ì§€ ì‹œì¦Œ ë„ì°©! ê³µê¸° ê´€ë¦¬ í•„ìˆ˜í…œ > {base_url}

ğŸ”¥ ê°€ê²© & í•œì •íŒ ê°•ì¡°í˜•
ì´ ê°€ê²©ì— ì´ í€„ë¦¬í‹°? ê³ ë¯¼í•  ì‹œê°„ ì—†ìŒ. > {base_url}
ì´ ê°€ê²© ì‹¤í™”ëƒ? ì•ˆ ì‚¬ë©´ í›„íšŒí•  ë“¯ > {base_url}
ì´ ê°€ê²©ì´ë©´ ìŸì—¬ë‘¬ì•¼ í•˜ëŠ” ê±° ì•„ë‹˜? > {base_url}
ê°€ê²© ë³´ê³  ì‹¬ì¥ ë›°ëŠ” ì¤‘. ì§€ê¸ˆ ë°”ë¡œ êµ¬ë§¤ê° > {base_url}
ì¼ ë“¤ì–´ê°”ëŒ€. ì–˜ë“¤ì•„ ë‹¬ë ¤ë¼ > {base_url}

## Hashtags:
#íŒ¨ì…˜ìŠ¤íƒ€ê·¸ë¨ #ìš´ë™ë³µì¶”ì²œ #ootd #ì¼ìƒë£© #ìŠ¤í¬í‹°ë£© #ì—¬ìì˜· #ìŠ¤íƒ€ì¼ë§ #ì‡¼í•‘
#ì¸ìƒí…œ #ì‚´ë¦¼ê¿€í…œ #ë‚´ëˆë‚´ì‚° #ì§‘ê¾¸ë¯¸ê¸° #í¸ë¦¬ë¯¸ì—„ #í•„ìˆ˜í…œ #ì‚´ë¦¼í…œ #ìë™ì²­ì†Œ

[Notes]
ì „ì²´ ê²Œì‹œê¸€ê³¼ ì´ë¯¸ì§€ ìº¡ì…˜ì€ ë³„ê°œë¡œ ì‘ì„±ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
ì œí’ˆ ì§ì ‘ ì„¤ëª…ì„ í”¼í•˜ê³ , ìì—°ìŠ¤ëŸ¬ìš´ ìŠ¤í† ë¦¬í…”ë§ê³¼ ê³µê°ì„ ìœ ë„í•˜ëŠ” ë‚´ìš©ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”.
20~30ëŒ€ ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ìœ í–‰í•˜ëŠ” ì–¸ì–´ì™€ ìŠ¤íƒ€ì¼ì„ ì ê·¹ í™œìš©í•˜ì„¸ìš”.
"""

    data["image_count"] = len(images)

    prompt = replace_prompt_with_data(prompt, data)

    content = [{"type": "text", "text": prompt}]
    for image in images:
        content.append({"type": "image_url", "image_url": {"url": image}})

    response_schema = {
        "name": "response_schema",
        "schema": {
            "type": "object",
            "properties": {
                "response": {
                    "type": "object",
                    "properties": {
                        "caption": {
                            "type": "array",
                            "description": "caption for making video.",
                            "items": {"type": "string"},
                        },
                        "description": {
                            "type": "string",
                            "description": "The description of the post.",
                        },
                        "hashtag": {
                            "type": "string",
                            "description": "The associated hashtag.",
                        },
                    },
                    "required": ["caption", "description", "hashtag"],
                    "additionalProperties": False,
                }
            },
            "required": ["response"],
            "additionalProperties": False,
        },
        "strict": True,
    }

    return call_chatgpt(content, response_schema, post_id)


def call_chatgpt_clear_product_name(name):
    prompt = """ì œê³µëœ ëª©ë¡ì—ì„œ ë¶ˆí•„ìš”í•œ ì„¸ë¶€ ì •ë³´ë¥¼ ì œê±°í•˜ê³  í˜•ì‹ì„ í‘œì¤€í™”í•˜ì—¬ ì œí’ˆ ì´ë¦„ì„ ì •ë¦¬ ë° ê°œì„ í•˜ì„¸ìš”.

ì£¼ìš” ë‹¨ê³„
ì œê³µëœ ì œí’ˆ ì´ë¦„ì„ ì‹ë³„í•˜ê³  ë¶„ì„í•˜ë©°, ê° ì œí’ˆì„ ì •ì˜í•˜ëŠ” í•„ìˆ˜ ìš”ì†Œì— ì§‘ì¤‘í•©ë‹ˆë‹¤.
ì œí’ˆ ì´ë¦„ì˜ ê³ ìœ ì„±ì„ ì§ì ‘ì ìœ¼ë¡œ ë‚˜íƒ€ë‚´ì§€ ì•ŠëŠ” ìˆ˜ëŸ‰, í¬ê¸°, ìƒì„¸ ì‚¬ì–‘ ë“± ë¶ˆí•„ìš”í•œ ì„¸ë¶€ ì •ë³´ë¥¼ ì œê±°í•©ë‹ˆë‹¤.
ë¸Œëœë“œ ì´ë¦„ê³¼ ì£¼ìš” íŠ¹ì§• ë“± ì œí’ˆì„ ë‹¤ë¥¸ ì œí’ˆê³¼ êµ¬ë¶„í•  ìˆ˜ ìˆëŠ” ì¤‘ìš”í•œ ì •ë³´ë¥¼ ìœ ì§€í•©ë‹ˆë‹¤.
ëª…í™•ì„±ê³¼ ë‹¨ìˆœì„±ì„ ìœ„í•´ ê° ì œí’ˆ ì´ë¦„ì„ ê°„ê²°í•˜ê²Œ ì¬êµ¬ì„±í•©ë‹ˆë‹¤.
ì¶œë ¥ í˜•ì‹
ê° ì´ë¦„ì„ ê°œë³„ í•­ëª©ìœ¼ë¡œ ë‚˜ì—´í•œ ê¹”ë”í•˜ê³  ì •ì œëœ ì œí’ˆ ì´ë¦„ ëª©ë¡ì„ ì œê³µí•©ë‹ˆë‹¤.
ì¶œë ¥ ë°ì´í„°ëŠ” ë°˜ë“œì‹œ í•œêµ­ì–´ë¡œ ì‘ì„±ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
ì˜ˆì‹œ
ì…ë ¥: í©í‹°ë“œ AtoZ íƒ„ë ¥ ì£¼ë¦„ê°œì„  ì—ì„¼ìŠ¤50ml 6ê°œ
ì¶œë ¥: í©í‹°ë“œ AtoZ íƒ„ë ¥ ì£¼ë¦„ê°œì„  ì—ì„¼ìŠ¤

ì…ë ¥: ì—ìŠ¤ë¡œì²´ ì „ë©´ ì˜¤í”ˆ ê¸°ë‚´ìš© ìºë¦¬ì–´ 20ì¸ì¹˜ 24ì¸ì¹˜ 28ì¸ì¹˜ ìºë¦¬ì–´
ì¶œë ¥: ì—ìŠ¤ë¡œì²´ ì „ë©´ ì˜¤í”ˆ ê¸°ë‚´ìš© ìºë¦¬ì–´

ì…ë ¥: ë°”ì„¸ë¦° ë°”ë”” í”„ë¡œí…íŒ… ì ¤ë¦¬ ì•Œë¡œì—, 100ml, 1ê°œ
ì¶œë ¥: ë°”ì„¸ë¦° ë°”ë”” í”„ë¡œí…íŒ… ì ¤ë¦¬ ì•Œë¡œì—

ì…ë ¥: TORSO í† ë¥´ì†Œ T76 ë°œë¦¬ì˜¤ìŠ¤ ë©€í‹° ë‹¤ì´ì•„ëª¬ë“œ ì›Œì¹˜ ë‚¨ì ë©”íƒˆ ì‹œê³„ (ê°€ì£½ ìŠ¤íŠ¸ë© ì¦ì •)
ì¶œë ¥: í† ë¥´ì†Œ ë°œë¦¬ì˜¤ìŠ¤ ë©€í‹° ë‹¤ì´ì•„ëª¬ë“œ ì›Œì¹˜

ì…ë ¥: ê°¸ìŠ¤ë¹„ ì…‹&í‚µ í—¤ì–´ìŠ¤í”„ë ˆì´ ìŠˆí¼í•˜ë“œ 263ml 2ê°œ, 263ml, 2ê°œ
ì¶œë ¥: ê°¸ìŠ¤ë¹„ ì…‹&í‚µ í—¤ì–´ìŠ¤í”„ë ˆì´ ìŠˆí¼í•˜ë“œ

ì°¸ê³ ì‚¬í•­
ì¶œë ¥ ê²°ê³¼ê°€ ìœ ì‚¬í•œ ì œí’ˆê³¼ êµ¬ë¶„ë  ìˆ˜ ìˆë„ë¡ í•„ìˆ˜ ì†ì„±ê³¼ ë¸Œëœë“œ ì´ë¦„ì„ í¬í•¨í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.
ì°¨ë³„í™”ë¥¼ ìœ„í•´ í•„ìš”í•œ ì •ë³´ê°€ ìˆëŠ” íŠ¹ë³„í•œ ê²½ìš°ì—ëŠ” í•´ë‹¹ ì •ë³´ë¥¼ í¬í•¨í•©ë‹ˆë‹¤."""

    content = [{"type": "text", "text": name}]

    response_schema = {
        "name": "response_schema",
        "schema": {
            "type": "object",
            "properties": {
                "response": {
                    "type": "object",
                    "properties": {
                        "product_name": {
                            "type": "string",
                            "description": "New Product name",
                        },
                    },
                    "required": ["product_name"],
                    "additionalProperties": False,
                }
            },
            "required": ["response"],
            "additionalProperties": False,
        },
        "strict": True,
    }
    return call_chatgpt(content, response_schema, 0, prompt, 1.0)


def call_chatgpt_get_main_text_and_color_for_image(
    input_text, requested_fields, post_id=0
):
    prompt = """ë‹¹ì‹ ì€ ìƒ‰ìƒ ë””ìì¸ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ë‹¤ìŒ ìš”êµ¬ ì‚¬í•­ì„ ì¶©ì¡±í•˜ëŠ” ìƒ‰ìƒ íŒ”ë ˆíŠ¸ë¥¼ ë§Œë“¤ì–´ ì£¼ì„¸ìš”.

1. **ì£¼ìš” í…ìŠ¤íŠ¸ ìƒ‰ìƒ (`main_text_color`)**: ë°ê³  ëˆˆê¸¸ì„ ë„ëŠ” ìƒ‰ìƒì´ë©°, ì—´ëŒ€ì ì¸ ëŠë‚Œì´ ë‚˜ëŠ” ìƒ‰ìƒì„ ì„ íƒí•˜ì„¸ìš”.  
2. **ë³´ì¡° í…ìŠ¤íŠ¸ ìƒ‰ìƒ**: í•­ìƒ í°ìƒ‰ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.  
3. **ë°°ê²½ ìƒ‰ìƒ (`background`)**: ì£¼ìš” í…ìŠ¤íŠ¸ ìƒ‰ìƒ ë° ë³´ì¡° í…ìŠ¤íŠ¸(í°ìƒ‰)ì™€ ì¢‹ì€ ëŒ€ë¹„ë¥¼ ì´ë£¨ëŠ” ë°ì€ ìƒ‰ìƒì„ ì„ íƒí•˜ì„¸ìš”.  
4. **ë°°ê²½ ìƒ‰ìƒì´ ë„ˆë¬´ ë‹¨ì¡°ë¡­ê±°ë‚˜ í°ìƒ‰ê³¼ ë¹„ìŠ·í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•˜ì„¸ìš”. "ì—°í•œ ë¶„í™", "ì—°í•œ ë…¸ë‘" ë“±ì˜ ìƒ‰ìƒì´ ì ì ˆí•©ë‹ˆë‹¤.**  

ë˜í•œ, ì•„ë˜ì˜ ë¬¸ì¥ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ ë¬¸ì¥ì—ì„œ í•µì‹¬ ë‚´ìš©ì„ ì°¾ì•„ `main_text` ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ì„¸ìš”.  

"{input_text}"  

ì œê°€ ì›í•˜ëŠ” ë°ì´í„° í•„ë“œëŠ” `{requested_fields}` ì…ë‹ˆë‹¤.  

**ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ì„¸ìš” (ìš”ì²­í•œ í•„ë“œë§Œ í¬í•¨)**:
```json
{
    "main_text": "ë¬¸ì¥ì˜ í•µì‹¬ ë‚´ìš©",
    "main_text_color": "", // ì˜ˆ: "#FF5733"
    "background": "" // ì˜ˆ: "#FFF9C4"
}

"""
    prompt = replace_prompt_with_data(
        prompt, {"input_text": input_text, "requested_fields": requested_fields}
    )

    response_schema = {
        "name": "response_schema",
        "schema": {
            "type": "object",
            "properties": {
                "main_text": {
                    "type": "string",
                    "description": "Main Text",
                },
                "main_text_color": {
                    "type": "string",
                    "description": "Main Text Color",
                },
                "background_color": {
                    "type": "string",
                    "description": "Background Color",
                },
            },
            "required": ["main_text", "main_text_color", "background_color"],
            "additionalProperties": False,
        },
        "strict": True,
    }
    return call_chatgpt(prompt, response_schema, post_id)


def replace_prompt_with_data(prompt, data):
    for key, value in data.items():
        prompt = prompt.replace("{" + key + "}", str(value))
    return prompt


def call_chatgpt(
    content, response_schema, post_id=0, base_prompt=None, temperature=0.9, retry=0
):
    client = OpenAI(api_key=chatgpt_api_key)
    model = "gpt-4o-mini"

    messages = []
    if base_prompt:
        messages.append({"role": "system", "content": base_prompt})
    messages.append({"role": "user", "content": content})

    request_log = json.dumps(
        {
            "model": model,
            "messages": messages,
            "response_format": {
                "type": "json_schema",
                "json_schema": response_schema,
            },
            "max_tokens": 3000,
            "temperature": temperature,
        }
    )

    try:
        response = client.chat.completions.create(
            model=model,
            messages=[
                {
                    "role": "user",
                    "content": content,
                }
            ],
            response_format={
                "type": "json_schema",
                "json_schema": response_schema,
            },
            max_tokens=5000,
            temperature=0.9,
        )
        response_log = json.dumps(response.to_dict())

        if response:
            content = response.choices[0].message.content or None
            usage = response.usage
            prompt_tokens = usage.prompt_tokens
            completion_tokens = usage.completion_tokens
            prompt_cache_tokens = usage.prompt_tokens_details.cached_tokens
            prompt_audio_tokens = usage.prompt_tokens_details.audio_tokens
            completion_reasoning_tokens = (
                usage.completion_tokens_details.reasoning_tokens
            )
            completion_audio_tokens = usage.completion_tokens_details.audio_tokens
            completion_accepted_prediction_tokens = (
                usage.completion_tokens_details.accepted_prediction_tokens
            )
            completion_rejected_prediction_tokens = (
                usage.completion_tokens_details.rejected_prediction_tokens
            )
            total_tokens = usage.total_tokens

            status = 1
            if not content:
                status = 0
            RequestLogService.create_request_log(
                post_id=post_id,
                ai_type="chatgpt",
                request=request_log,
                response=response_log,
                prompt_tokens=prompt_tokens,
                prompt_cache_tokens=prompt_cache_tokens,
                prompt_audio_tokens=prompt_audio_tokens,
                completion_tokens=completion_tokens,
                completion_reasoning_tokens=completion_reasoning_tokens,
                completion_audio_tokens=completion_audio_tokens,
                completion_accepted_prediction_tokens=completion_accepted_prediction_tokens,
                completion_rejected_prediction_tokens=completion_rejected_prediction_tokens,
                total_tokens=total_tokens,
                status=status,
            )
            if not status:
                if retry < 2:
                    return call_chatgpt(
                        content, response_schema, post_id, base_prompt, retry=retry + 1
                    )
            return content
        return None
    except Exception as e:
        response_log = json.dumps({"error": str(e)})
        RequestLogService.create_request_log(
            post_id=post_id,
            ai_type="chatgpt",
            request=request_log,
            response=response_log,
            status=0,
        )
        return None
